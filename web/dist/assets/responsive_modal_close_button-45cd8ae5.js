import{Z as g,r as o,cV as E,n as P,aa as R,c1 as _,l as y,cW as h,cX as x,k as z,v as D}from"./index-d2f5e843.js";import{b as v,g as J}from"./scenes-b1ce238d.js";import{JukeboxContext as A}from"./jukebox-47a666c9.js";function W(e){return g({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M576 240c0-23.63-12.95-44.04-32-55.12V32.01C544 23.26 537.02 0 512 0c-7.12 0-14.19 2.38-19.98 7.02l-85.03 68.03C364.28 109.19 310.66 128 256 128H64c-35.35 0-64 28.65-64 64v96c0 35.35 28.65 64 64 64h33.7c-1.39 10.48-2.18 21.14-2.18 32 0 39.77 9.26 77.35 25.56 110.94 5.19 10.69 16.52 17.06 28.4 17.06h74.28c26.05 0 41.69-29.84 25.9-50.56-16.4-21.52-26.15-48.36-26.15-77.44 0-11.11 1.62-21.79 4.41-32H256c54.66 0 108.28 18.81 150.98 52.95l85.03 68.03a32.023 32.023 0 0 0 19.98 7.02c24.92 0 32-22.78 32-32V295.13C563.05 284.04 576 263.63 576 240zm-96 141.42l-33.05-26.44C392.95 311.78 325.12 288 256 288v-96c69.12 0 136.95-23.78 190.95-66.98L480 98.58v282.84z"}}]})(e)}function X(e){return g({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"}}]})(e)}function Y(e){return g({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M305.44954,462.59c7.39157,7.29792,6.18829,20.09661-3.00038,25.00356-77.713,41.80281-176.72559,29.9105-242.34331-35.7082C-5.49624,386.28227-17.404,287.362,24.41381,209.554c4.89125-9.095,17.68975-10.29834,25.00318-3.00043L166.22872,323.36708l27.39411-27.39452c-.68759-2.60974-1.594-5.00071-1.594-7.81361a32.00407,32.00407,0,1,1,32.00407,32.00455c-2.79723,0-5.20378-.89075-7.79786-1.594l-27.40974,27.41015ZM511.9758,303.06732a16.10336,16.10336,0,0,1-16.002,17.00242H463.86031a15.96956,15.96956,0,0,1-15.89265-15.00213C440.46671,175.5492,336.45348,70.53427,207.03078,63.53328a15.84486,15.84486,0,0,1-15.00191-15.90852V16.02652A16.09389,16.09389,0,0,1,209.031.02425C372.25491,8.61922,503.47472,139.841,511.9758,303.06732Zm-96.01221-.29692a16.21093,16.21093,0,0,1-16.11142,17.29934H367.645a16.06862,16.06862,0,0,1-15.89265-14.70522c-6.90712-77.01094-68.118-138.91037-144.92467-145.22376a15.94,15.94,0,0,1-14.79876-15.89289V112.13393a16.134,16.134,0,0,1,17.29908-16.096C319.45132,104.5391,407.55627,192.64538,415.96359,302.7704Z"}}]})(e)}function K(e){return g({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M104 224H24c-13.255 0-24 10.745-24 24v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V248c0-13.255-10.745-24-24-24zM64 472c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zM384 81.452c0 42.416-25.97 66.208-33.277 94.548h101.723c33.397 0 59.397 27.746 59.553 58.098.084 17.938-7.546 37.249-19.439 49.197l-.11.11c9.836 23.337 8.237 56.037-9.308 79.469 8.681 25.895-.069 57.704-16.382 74.757 4.298 17.598 2.244 32.575-6.148 44.632C440.202 511.587 389.616 512 346.839 512l-2.845-.001c-48.287-.017-87.806-17.598-119.56-31.725-15.957-7.099-36.821-15.887-52.651-16.178-6.54-.12-11.783-5.457-11.783-11.998v-213.77c0-3.2 1.282-6.271 3.558-8.521 39.614-39.144 56.648-80.587 89.117-113.111 14.804-14.832 20.188-37.236 25.393-58.902C282.515 39.293 291.817 0 312 0c24 0 72 8 72 81.452z"}}]})(e)}const B=()=>o.useContext(A),I=()=>o.useContext(E);function O(e,n){const a=JSON.stringify(n.params);return e.findIndex(s=>s.routeName===n.name&&JSON.stringify(s.routeParams)===a)}function p(e,n){const a=O(e,n);return a===void 0?null:e[a]}const k=()=>o.useContext(v),H=()=>o.useContext(v).filter(e=>e.type==="level"),L=()=>o.useContext(v).filter(e=>e.type==="journal");function V(){const e=k(),{route:n}=P(""),[a,s]=o.useState(p(e,n));return o.useEffect(()=>{s(p(e,n))},[n,e]),a}function M(e){for(let n=e.length-1;n>=0;n-=1)if(e[n].unlocked)return e[n];return e[0]}function $(){const e=k();return M(e)}function e2(){const e=H();for(let n=0;n<e.length;n+=1)if(!e[n].unlocked)return e[n];return e[e.length-1]}function t2(){const e=V(),n=R(),a=L(),{getSoundOrNull:s,getSound:C}=_(),d=o.useRef(null),{requestSong:u,stopAllMusic:i}=B(),[m]=I(),[j,Z,r]=y(),l=o.useCallback(t=>{if(n.navigate(t.routeName,t.routeParams??{}),t.initialSound!=null){d.current&&clearTimeout(d.current);const c=s(t.initialSound);c&&(c.stop(),d.current=setTimeout(()=>c.play(),250))}t.music!=null?u(t.music):i(h),t.newFunctions!=null&&t.newFunctions.length>0&&m(t.newFunctions)},[s,u,n,m,i]),T=o.useCallback(()=>{if(!e)throw new Error("Could not get current scene.");const{nextScene:t}=e;if(t==null)throw new Error("Could not get next scene.");l(t)},[e,l]),S=o.useCallback(()=>{const t=C("ringtone");if(t.stop(),!r)return;const c=J(r.current.levelStates,r.current.seenJournalPages,r.current.seenDialogTrees,r.current.seenCutscenes);M(c).type==="dialog"&&t.play()},[C,r]),b=o.useCallback(()=>{u("hubAmbience"),n.navigate("hub");let t=null;return t&&clearTimeout(t),t=setTimeout(S,x),()=>{t&&clearTimeout(t)}},[u,n,S]),N=o.useCallback(()=>{n.navigate("title");let t=null;return t&&clearTimeout(t),t=setTimeout(()=>{u("prelude")},x),()=>{t&&clearTimeout(t)}},[u,n]),w=o.useCallback(()=>{const t=a.filter(f=>f.unlocked);if(t.length===0)throw new Error("Could not find any unlocked journal pages.");const c=t.filter(f=>!f.completed),U=c.length>0?c[0]:t[t.length-1];l(U)},[a,l]),F=o.useCallback(t=>{i(h),n.navigate("cutscene",{cutsceneId:t})},[n,i]);return{navigateToScene:l,navigateToNextScene:T,navigateToHub:b,navigateToTitle:N,navigateToNextJournalPage:w,navigateToCutscene:F}}function n2(){return z.jsx(D,{size:"sm"})}export{W as F,n2 as R,B as a,H as b,L as c,$ as d,Y as e,V as f,K as g,e2 as h,X as i,t2 as u};
